# doesn't work env vars form zsh - only form .profile
# kitty ma flagi --title i --name a st tylko -t/T i -n 
# sudo -A or gksu - popup with password
# pattern for 3 actions
# super + {_,shift,ctrl} + z 
#super + {_,shift + }{1-9,0} dwa zakresy
#	bspc {desktop -f,node -d} '^{1-9,10}'
 # \~fullscreen "~\" toggle
 
# make sxhkd reload its configuration files:
super + Home
	pkill -USR1 -x sxhkd
	# bspc wm -r ?

# kill rofi
super + Escape
	{$ROFI/kill}

# Show manual; keybindings
super + {ctrl,shift} + F1
	{$ROFI/bspwm-help, mp rofi}

# In case bspwmrc fails to execute/you wish have plugged in a new monitor
super + shift + r
	bspwmrc
#
# Window manipulation
# ______________

# Close/kill window
super + {_,shift} + q
	bspc node -{c,k}

# floating/all tile/all floating
super + {_,shift,ctrl} + space
	{bspc node -t \~floating && window-placer $(bspc query -T -d | grep -o '"state":"floating"' | wc -l), \
	bspcp tile, bspcp float }
# super + shift + @space - release
	# {bspc node -t floating && window-placer $(bspc query -T -d | grep -o '"state":"floating"' | wc -l),bspc node -t tiled}

# Toggle tiling mode of window, but save layout
super + shift + ctrl + space
	bspc node -t \~pseudo_tiled

# Toggle monocle/fullscreen mode
super + {_,shift} + f 
	{bspc desktop -l next, bspc node -t \~fullscreen}
#
#### FLAGS
# ______________    

# sticky works only on the one monitor
super + a ; {l,m,s,p}
	bspc node -g {locked,marked,sticky,private}
# send the newest marked node to the newest preselected node trzeba mieć preselected 
super + a ; b
	bspc node newest.marked.local -n newest.!automatic.local

# hide
super + {_,shift,ctrl} + z
     whid {last, hide, dmenu}

super + u
	bspc node -f any.urgent

#
# Window moving and splitting
# ______________    

## Workspaces
super + {1-9,0}
	bspc desktop -f ^{1-9,10}
	# bspc desktop -f "$(bspc query -D | sed -n "{1-9,10} p")"
# move node to workspace and follow
super + shift + {1-9,0}
    bspc node -d '^{1-9,10}' --follow
    # id=$(bspc query -N -n); bspc node -d ^{1-9,10}; bspc node -f ${id}
	
# Select previous / next active desktop
super + {p,n}
	bspc desktop -f {prev,next}.occupied

# Select previous / next active desktop
super + ctrl + {p,n}
	bspc desktop -f {prev,next}

# move node to next workspace and follow
super + shift + {n,p}
    id=$(bspc query -N -n focused); \
    bspc node -m {prev,next}; \
    bspc node -f ${id}
	
# swap with the biggest/smallest node
# todo change shortcut
super + ctrl + {_,shift} + Tab
	bspc node -s {biggest,smallest}.local

# swap with the first window in selected desktop
super + ctrl + {1-9,0}
	bspc node -s $(bspc query -N -n .window -d {1-9,0})

# cycle windows in the same desktop
alt + {_,shift} + Tab
    bspc node -f {next,prev}.local

# go to the last workspace, monitor 
super + {_,shift} + Tab
	bspc {desktop,monitor} -f last

super + {h,j,k,l}
    focusmover {west,south,north,east}
	# bspc node -f {west,south,north,east}

super + {Left,Down,Up,Right}
    focusmover {west,south,north,east}
        	
# moves floating windows instead of changing 
super + shift + {h,j,k,l}
	euclid_mover {west,south,north,east}
	# windowgrabber {west,south,north,east}
	
# breaks in floating windows
super + shift + {Left,Down,Up,Right}
	bspc node -s {west,south,north,east}

# resize	
super + ctrl + {h,j,k,l}
	bspwm_resize.sh {west,south,north,east}

super + ctrl + {Left,Down,Up,Right}
	bspwm_resize.sh {west,south,north,east}

#
# Layout manipulation/desktop level controls
# ______________    

# Toggle Balance tree
super + {_,shift} + b
	bspc node @/ -{B,E}

# Rotate leaves of tree
super + {bracketright,bracketleft}
	bspc node @/ -R {90,270}

# Mirror and flip leaves of tree
super + shift + {bracketleft,bracketright}
	bspc node @/ -F {horizontal,vertical}

#Change window gap
super + ctrl + g
	bspc config -d focused window_gap {$gap,$(($gap+$gap)),$(($gap+$gap+$gap))}

super + button{4,5}
	bspc config -d focused window_gap $((`bspc config -d focused window_gap` {+,-} 2 ))

###### RECEPTACLE  and PRESELECTION
# ______________    
#
# in preselection new window will be display in preselected area 

# Receptacle ok tylko dać jakieś fajne skróty
super + semicolon ; {h,j,k,l}
	bspc node --presel-dir \~{west,south,north,east} -i

# move window to Receptacle
super + shift + semicolon
	bspc node $(bspc query -N -n focused) -n $(bspc query -N -n .leaf.\!window)

# Remove receptacles
super + shift + BackSpace
	for i in $(bspc query -N -n .leaf.!window.local); do bspc node $i -k; done

# Autopresel (split window in its largest dimension) - p preselection 
super + semicolon ; {p,semicolon}
	{auto-presel,bspc node -i}
#
# APPLICATIONS
# ______________    
#

super + Return
	$TERM_DEF

super + shift + Return
	$TERM_LT

# dropdown TODO show but as a normal window 
F12
	tdrop -m --wm bspwm -w -4 -y "$PANEL_HEIGHT" $TERM_LT -t dropdown

# left/middle click emulation
super + {x,v} 
	xdotool click --clearmodifiers {1,2}

super + {_,shift} + i
	{gksu net-restart.sh, \
	nmcli device wifi connect $(awk '\{print $1\}' $PRIVATE/wifi) password $(awk '\{print $2\}' $PRIVATE/wifi)}
	
super + F{1,2,3,4,7,8,9,10,11,12}
	{ $BROWSER, \
	/opt/idea-IU-212.5284.40/bin/idea.sh, \
	$TERM_DEF start --class vifm -- vifm, \
	pcmanfm, \
	sh -c 'cd $NOTE; $TERM_LT -t note nvim', \
	todo.lua show, \
	todo.lua add, \
	pamac-manager, \
	sh -c $(ls ~/.bin | rofi -dmenu), \
	rofi -show power-menu -modi power-menu:$ROFI/rofi-power-menu
	}
# super + F6 surf https://clockify.me/tracker,

# show/add into todo list; add event to the google calendar
super + {_,shift,ctrl} + y
	{ pomodoro.lua add, todo.lua add, gcal-add.lua }

super + {_,shift,ctrl} + Delete 
	{rmmpv-playing.sh, rmmpd-playing.sh, xkill}

super + BackSpace
	$TERM_LT -t top -n top -e btm


# search
super + {_, shift,ctrl} + g
	{search.lua google primary, search.lua google clip, search.lua google primary}

super + s ; {s,h,g,G,b,B,u,U,y,Y,m,M}
	{ dunstify options: " (capital-clipboard):\nh-help menu\ng-google\nb-brave\nu-duckduck\ny-yt\nm-maps\nw-wiki\nc-ceneo\no-cenowarka\na-allegro\nz-amazon\ns-so\nf-filmweb\nd-diki\nl-deepL\nr-translator\np-pl-en trans\ne-en-pl trans\nx-tuxi\nt-tor\ni-info from cheatsh", \
	search.lua menu input, \
	search.lua google primary, search.lua google clip, \
	search.lua brave primary, search.lua brave clip, \
	search.lua dd primary, search.lua dd clip, \
	search.lua yt primary, search.lua yt clip, \
	search.lua maps primary, search.lua maps clip}

super + s ; {w,W,c,C,o,O,a,A,z,Z,f,F,x,X,t,T}
	{ search.lua wiki primary, search.lua wiki clip, \
	search.lua ceneo primary, search.lua ceneo clip, \
	search.lua cenowarka primary, search.lua cenowarka clip, \
	search.lua allegro primary, search.lua allegro clip, \
	search.lua amazon primary, search.lua amazon clip, \
	search.lua filmweb primary, search.lua filmweb clip, \
	search.lua tuxi input, search.lua tuxi clip, \
	search.lua tor primary, search.lua tor clip }

super + s ; {d,D,l,L,r,R,p,P,e,E,i,I}
	{ search.lua diki primary, search.lua diki clip, \
	search.lua deepl primary, search.lua deepl clip, \
	search.lua translator primary, search.lua translator clip, \
	search.lua plen primary, search.lua plen clip, \
	search.lua enpl primary, search.lua enpl clip, \
	search.lua cheat input, search.lua cheat primary }
	# search.lua so primary, search.lua so clip, \ anti bot checker

# tui
super + o ; {o,i,p,b,t}
	$TERM_LT -e {notify-send options: "i-nmtui\np-ncmcpp\nb-bmenu\nm-menu\nt-telegram", \
		nmtui,ncmpcpp,bmenu,tg}

# script in background - url.lua menu will ask for the number of the links
super + e ; {e,h,k,K,m,M,v,V,a,A,y,Y,g,G,w,W,r,R,c,i}
	{dunstify options: "h-help url menu\nm(M)-magnet\nv(V)-video\na(A)-audio dl\ny(Y)-yt dl\ng(G)-gallery-dl\nw(w)-wget\nr-speed reader\nR-read\nc-calendar\nk(K)-kindle\ni-investing", \
    url.lua menu input, \
    url.lua kindle 1,  url.lua kindle 10, \
    url.lua tor 1,  url.lua tor 10, \
    url.lua video 1,  url.lua video 10, \
    url.lua audio 1,  url.lua audio 10, \
    url.lua yt 1,  url.lua yt 10,  \
    url.lua gallery 1,  url.lua gallery 10,  \
    url.lua wget 1, url.lua wget 10,  \
    url.lua speed 1, url.lua read 1,  \
	gcal-show.sh, investing-cli -n
}

ctrl + shift + z
	$ROFI/clipster/roficlip

# clipster and notes; add J nad fix previous-copy primary
super + c ; {c,g,p,r,R,j,J,n,N,k,K,l,L,w}
	{dunstify options: "g-gui\np-(prim)selection\nr[R]-remove clip/sel\nj[J]-join clip/sel\nn(N)-next clip/sel\nk(K)-note from clip\nl(L)-note from sel\nw -write note", \
	clipster -sc, \
	$ROFI/clipster/roficlip-primary, \
	clipster -cr, clipster -r, \
	clipster.lua join clipboard, clipster.lua join primary, \
	clipster.lua next clipboard, clipster.lua next primary, \
	note.lua clip 1, note.lua clip, \
	note.lua sel 1, note.lua sel, \
	note.lua write
	}
super + shift + c 
	clipster.lua next clipboard 
#
# ROFI 
# ______________    

# rofi top and calc are in aur repo
super + d
	rofi -modi window,calc,top -show window -show-icons -sidebar-mode -monitor -4 -matching fuzzy

super + shift + d
	rofi -modi drun,run,window -show drun -show-icons -sidebar-mode -monitor -4 -matching fuzzy

# rofi scripts TODO path
super + ctrl + d
	 $ROFI/mbmain
# bindsym $mod+shift+d exec --no-startup-id "rofi -modi window,top,drun -show window -show-icons -sidebar-mode -terminal st"

alt + space
	 $ROFI/expander/expander.sh
# rofi locate
super + ctrl + f 
	$ROFI/locate-video.py
	# rofi-finder.sh
 # $ROFI/locate.py

# translator 
super + {_,shift,ctrl} + t
	{	search.lua enpl primary, \
		$ROFI/tran/trans-launcher.sh, \
		search.lua plen primary
	}
# mount 
super + ctrl + u
	$ROFI/mount-launcher.sh
#
# MEDIA KEYS
# ______________    
# audio and mpd
XF86Audio{Raise,Lower}Volume
	pactl set-sink-volume 0 {+,-}10%
XF86AudioMute
	pactl set-sink-mute 0 toggle
	# volume toggle
super + {equal,plus}
	pactl set-sink-volume 0 +{5,15}%
	# ~/.i3/volume
	# amixer sset Master {5,15}%+ && notify-send $(awk -F"[][]" '/Front Left:/ { print $2 }' <(amixer sget Master))
# Decrease volume
super {_,shift +} + minus
	pactl set-sink-volume 0 -{5,15}% 
	# ~/.i3/volume
	# amixer sset Master {5,15}%- && notify-send $(awk -F"[][]" '/Front Left:/ { print $2 }' <(amixer sget Master))
super + slash
	pactl set-sink-mute 0 toggle
	# volume toggle
	# amixer sset Master toggle

super + shift + m
	mpd && $TERM_LT -t music -n music -e ncmpcpp && mpc update

super + m
	mpc toggle
# Changes to next/previous tracks
super + {comma,period}
	mpc {prev,next}
# Restart track
super + shift + slash
	mpc seek 0%

# Seek foward in song
super + shift + {comma,period}
	mpc seek {-,+}50
# super + {_,shift +} bracketright - zajęte
	# mpc seek +{10,120}
# Seek backward in song
# super + {_,shift +} bracketleft
	# mpc seek -{10,120}
# Increase volume, chyba cudzysłowy nie działają 

#
# MOUSE BINDINGS
# __________________

~button1
	DidIClickDesktop.sh && gapgrab	

~button2
	# DidIClickDesktop.sh && BspwmDesktopMenu
#	DidIClickDesktop.sh && mygtkmenui -- .config/GTKmenu/BspwmDesktopMenui
#	DidIClickDesktop.sh && mygtkmenui -- .config/GTKmenu/BspwmWindowMenui
		
~button3
	DidIClickDesktop.sh && rofimenu -desktop
#DidIClickDesktop.sh && mygtkmenui -- .config/GTKmenu/LaunchMenu

# Switch workspace by scrolling on the desktop. Causes scrolling issues on some systems.
#~button4
#	DidIClickDesktop.sh && bspc desktop -f next
#~button5
#	DidIClickDesktop.sh && bspc desktop -f prev
	
### Add or remove desktops by scrolling
super + ctrl + button5
    bspcp dsktp rm

super + ctrl + button4
    bspcp dsktp add

# Spawn applications popup menu and manually tile selected 
# app where your mouse was when you opened the menu. Smartsplit only chooses
# biggest dimension of the window, MouseLaunch only cares which edge is closer.
# mod5 is alt_gr (first key right from space) on most keyboards. 
mod5 + @button1
	smartsplit ; rofimenu -desktop
#	smartsplit ; dboxmenu
#    MouseLaunch ; mygtkmenui -- .config/GTKmenu/LaunchMenu

# Spawn window manipulation menu
# Mod1 is alt
mod1 + @button1
	BspwmWindowMenu
# mygtkmenui -- .config/GTKmenu/BspwmWindowMenui


#
# Touchpad "gestures" (depend on your touchpad driver, very likely to be unavailable)
#_____________________
#
# ALTERNATIVETES
    
#super + {_,shift + }{1-9,0}
#	bspc {desktop -f,node -d} '^{1-9,10}'
## Alternative: i3 style behavior (focus nth, desktop of the focused monitor)
	# focusdesktopofthismonitor {1-9,10}
## Another alternative: xmonad style desktops. You have 10 desktops shared between all monitors,
## and focusing a desktop focuses it on the currently focused monitor
#super + {1-9,0}
#	summondesktop.sh {1-9,10}
#super + shift + {1-9,0}
#	bspc node -d ^{1-9,10}
#

# move a floating window
# with euclid_mover moving is not necessary 
# super + shift + ctrl + {h,j,k,l}
    # bspc node -v {-30 0,0 30,0 -30,30 0}
	# xdo move {-x -30,-y +30,-y -30,-x +30} # or with xdotool
# super + shift + ctrl + {Left,Down,Up,Right}
    # bspc node -v {-30 0,0 30,0 -30,30 0}
	# xdo move {-x -30,-y +30,-y -30,-x +30}

# Receptacle window for splitting in certain direction
# alt + ctrl + {h,j,k,l}
# 	bspc node --presel-dir \~{west,south,north,east} -i
# alt + ctrl + {Left,Down,Up,Right}
# 	bspc node -p \~{west,south,north,east} -i

 # Receptacle the desktop for splitting in certain direction
 # alt + shift + {h,j,k,l}
	 # bspc node @/ -p \~{west,south,north,east} -i
 # alt + shift + {Left,Down,Up,Right}
	 # bspc node @/ -p \~{west,south,north,east} -i
# move window to preselection
	# bspc node -n 'last.!automatic.local'
# Set splitting ratio of windows - prepare the space
#alt + ctrl + {1-9}
#	bspc node -o 0.{1-9}
		
# Move current window to largest space or preselected area if there is one.
#super + Return
#    windowpromoter

# bindsym $mod+i exec i3-msg 'workspace $ws4;exec --no-startup-id libreoffice ~/interview\ questions.odt; workspace $ws8; exec zathura ~/Arkadiusz_Mirosław_CV.pdf; workspace $ws4'
#
# Balance brother node. If you do this on biggest window of the desktop, it usually means balancing all windows with except the biggest.
# super + alt + b
	# bspc node @brother -B
# Toggle automatic balancing of windows ? how toggle todo
# alt + b
	# euclid_balancer

# move node to workspace don't follow
# super + ctrl + {1-9,0}
	# bspc node -d "$(bspc query -D -m | sed -n "{1-9,10} p")"
	# movetodesktopofthismonitor {1-9,10}

# move node to next and go to it
# bspc node -d {prev,next}.local -follow
# Send to last
# super + shift + equal
    # bspc node -m last --follow
	
# move to next monitor; prev 
# super + shift + {p,n}
	# bspc desktop -f {prev,next}.local
	
# Switch to the other monitor.
#mod3 + o
	# bspc monitor -f next


# UNUSED shortcut

# super + shift + s 

# OLD

	# rofi -modi dic:$ROFI/tran/dic-speak.sh,enpl:$ROFI/tran/enpl-notify.sh,plen:$ROFI/tran/plen-notify.sh -show enpl -sidebar-mode -terminal $TERM_LT -lines 1 -width 30 slow
