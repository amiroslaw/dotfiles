" vim: filetype=vim :
" DEPENDENCY
" rust - rip, fd, rg, 
" patool lub atool, feh or sxiv, meld, trash-cli, tree, du, pdfunite, udevil
" meld dragon-drop tesseract
"
" set grepprg="grep\ -n\ -H\ -I\ -r\ -i\ %i\ %a %s"
" set findprg="find %s %a -print -prune"

" :com[mand] command_name action
" Use %% if you need to put a percent sign in your command.
" The following macros can be used in a command
" %a is replaced with the user arguments.
" %c the current file under the cursor.
" %C the current file under the cursor in the other directory.
" %f the current selected file, or files.
" %F the current selected file, or files in the other directory.
" %b same as %f %F.
" %d the current directory name.
" %D the other window directory name.
" %m run the command in a menu window
" %i ignor output
" modifiers

" :p - full path
" :~ - relative to the home directory
" :. - relative to current directory
" :h - head of the file name
" :t - tail of the file name
" :r - root of the file name (without last extension)
" :e - extension of the file name (last one)
" :s?pat?sub? - substitute the first occurrence of pat with sub. You can use any character for '?', but it must not occur in pat or sub.
" :gs?pat?sub? - like :s, but substitutes all occurrences of pat with sub.

" The file type is for the default programs to be used with
" a file extension.
" :filetype pattern1,pattern2 defaultprogram,program2
" :fileviewer pattern1,pattern2 consoleviewer
" The other programs for the file type can be accessed with the :file command
" The command macros %f, %F, %d, %F may be used in the commands.
" The %a macro is ignored.  To use a % you must put %%.

" One window view
" only

set vicmd=nvim
" set vicmd=elvis\ -G\ termcap
" set vicmd=vile

" Trash Directory
" The default is to move files that are deleted with dd or :d to
" the trash directory.  If you change this you will not be able to move
" files by deleting them and then using p to put the file in the new location.
" I recommend not changing this until you are familiar with vifm.
" This probably shouldn't be an option.
set trash

" This is how many directories to store in the directory history.
set history=50

" Follow links on l or Enter.
set followlinks

" With this option turned on you can run partially entered commands with
" unambiguous beginning using :! (e.g. :!Te instead of :!Terminal or :!Te<tab>).
set nofastrun

" Natural sort of (version) numbers within text.
set nosortnumbers

" Maximum number of changes that can be undone.
set undolevels=100

" If you installed the vim.txt help file set vimhelp.
" If would rather use a plain text help file set novimhelp.
set novimhelp

" If you would like to run an executable file when you
" press return on the file name set this.
set norunexec

" Use KiB, MiB, ... instead of K, M, ...
set noiec

" Selected color scheme https://vifm.info/colorschemes.shtml
colorscheme near-default
" colorscheme gruvebox

" The FUSE_HOME directory will be used as a root dir for all FUSE mounts.
" Unless it exists with write/exec permissions set, vifm will attempt to
" create it.
set fusehome=/tmp/vifm_FUSE

" Format for displaying time in file list. For example:
" set timefmt=%m/%d-%H:%M
" See man date or man strftime for details.
set timefmt=\ %m/%d\ %H:%M


" What should be saved automatically between vifm runs
" Like in previous versions of vifm
" set vifminfo=options,filetypes,commands,bookmarks,tui,state,cs,chistory,shistory,dirstack,registers,phistory
" Like in vi
set vifminfo=bookmarks,chistory,shistory,phistory,savedirs,dhistory

"""""""""" my config
"""""""
set relativenumber
"don't create shortcut with d,y,p key
set ignorecase
set sort=+iname

" Show list of matches on tab completion in command-line mode
set wildmenu

" Display completions in a form of popup with descriptions of the matches
set wildstyle=popup

" Display suggestions in normal, visual and view modes for keys, marks and
" registers (at most 5 files).  In other view, when available.
set suggestoptions=normal,visual,view,otherpane,keys,marks,registers
"disable delete confirmation 
set confirm-=delete
" Total size of selected files To get the total size of selected files change %s to %E
set statusline="  %t%= %A %10u:%-7g %15E %20d  "
" Use ripgrep instead of grep wiht smart case
set grepprg=rg\ --color=never\ -SHn\ %i\ %a\ %s
" Use fd instead of find
set findprg=fd\ --color=never\ %p\ %s
nmap <C-A-f> :find <space> 
nmap <C-s> :grep <space>

" fzf finder
" sometimes doesn't work with I param
"command! fzf :execute '!fzf 2>&0 %%U' | normal! gf
nmap <C-f> :fzf <cr> 
command! fzf :execute '!fzf 2>&0 %%IU' | normal! gf
command! fzfcdh :execute 'cd' fnameescape(term('fd --hidden --type d | fzf 2> /dev/tty'))
nmap <A-f> :fzfcdh <cr>
" fzf finder hidden files doesn't work
" command! fzfd :execute '!fd -t d --color=never %p %s | fzf 2>&0 %%IU' | normal! gf
" command! fzfd :execute '!cd "$(fd -a --hidden --type d %p %s | fzf)"'

" nmap <C-f> :sk <cr> 
" command! sk :execute '!sk 2>&0 %%IU' | normal! gf
" nmap <A-f> :skd <cr>
" command! skd :execute '!fd -t d --color=never | sk 2>&0 %%IU' | normal! gf

" custom loop- finish command and push enter
noremap il :!for f in %f; do  "$f"; done<A-B><A-B><Left>

"archive
"atool don't work with rar?
nmap rr	:!atool -x %f <cr>
nmap RR	:!atool --extract-to=%D %f <cr>
nmap rc	:!atool -a %d:t.7z %f <cr> 
nmap rl	:!atool -l %f %m <cr> 
" nmap rr	:!patool extract %f <cr>
" nmap RR	:!patool extract --outdir %D %f <cr>
" nmap rc	:!patool create %d:t.7z %f <cr> 
" nmap rl	:!patool list %f %m <cr> 

" magicimage display resolution of image
nmap ii	:!identify %f %S <cr> 

"pdf combine
nmap cp	:!pdfunite %f %d:t.pdf <cr>
"pdftotext
nmap cP	:!pdftotext %c %c:r <cr>
"Tesseract OCR
nmap ct	:!tesseract %c %c:r <cr>
"dragon dr - drag from and dl drop to
nmap dr :!dragon-drop %f <cr> 
nmap dl :!dragon-pull.sh <cr>
" ffmpeg
noremap cm :!for i in %f; do  ffmpeg -i "$i" -f segment -segment_time 900 -c copy "${i%%.*}-%%02d.mp3"; done <cr>

" meld pliki pod kursorem
nmap <C-p> :!meld %c %C %i<cr> 
" copy text into other file
nmap cc :!cat %c >> %C <cr> 
" copy text from file
nmap <C-c> :!cat %c | xclip -sel clip<cr> 
" append text from clipboard into file
nmap <C-v> :!xclip -o -selection clipboard >> %c <cr>
"rozmiary katalogów
nmap du :!du -schL * %m<cr>
"change name without extension
nmap <F2> cW
" trash-cli or rm-improved
nmap <delete> :!trash-put %f<cr>
nmap DD :!rm -rf %f<cr>
"open in file manager
" nmap <F3> :! kitty -d %d %i & <cr>
nmap <F3> :! wezterm start --cwd %d %i & <cr>
"open in file manager
nmap <F4> :! pcmanfm %d %i & <cr>
" copy files to the opposite pane
nmap <F5> :!cp -r %f %D<cr>
" move files to the opposite pane
nmap <F6> :!mv %f %D &<cr>
nmap <F7> :mkdir <space>
" make dir from selected file name
nmap cd :mkdir %c:r <cr> 

nmap <F8> :touch <space> 
nmap cf :touch %c:r <cr> 


"COMAND VIFM
" shortcut list
nmap <C-l> :nmap <cr>
nmap ; :
nmap <space>	t
"select all
nmap aa ggvG<cr>
"unselect all
nmap au vv<cr>
nmap I :invert s <cr>
nmap S	:sync <cr>
nmap s	:sort <cr>
nmap X :shell <cr>
nmap U	:undolist <cr>
"podglad w panelu
nmap w	:view <cr>
" mount device mount by m
nmap <A-m> :media <cr>
" symbolic link, maybe change to cl
nmap al :alink<cr>

"historia dir
nmap o :history <cr>
" show command  history
nmap O :history cmd <cr>
" search history
nmap <C-h> :history search <cr>

" VIEWS
" one panel
nmap <C-o> :only<cr>
nmap tr :tree! <cr>
"tree directory under cursor with size
nmap T :!tree -h %c %m<cr>
"tabs
nmap tt :tabnew <cr>
nmap tn :tabnext <cr>
nmap <C-n> :tabnext <cr>
nmap tp :tabprevious <cr>

" CLIPBOARD COPY
" yank current directory path into the clipboard
nnoremap yd :!echo -n %d | xclip %i<cr>
" yank current file path into the clipboard
nnoremap yf :!echo -n %c:p | xclip %i<cr>
" yank current filename without path into the clipboard
nnoremap yn :!echo -n %c | xclip %i<cr>
" yank root of current file's name into the clipboard
nnoremap yr :!echo -n %c:r | xclip %i<cr>

nmap md :!typora %f &<cr>
nmap <C-e> :!goneovim %f &<cr>

" OPENING FILES
":filetype, but this command is ignored if not running in X. In X :filextype is equal to :filetype. 
" or xdg-open or dragon-drag-and-drop
" associacja :f  wybieramy program gdy mamy kilka ustawionych
" 2>/dev/null but better use %i
" Pdf need poppler and libcaca
filextype {*.pdf},<application/pdf> zathura %c %i &, pqiv %c, xreader %c
fileviewer {*.pdf},<application/pdf> pdftotext -nopgbrk %c -

" PostScript
filextype {*.ps,*.eps,*.ps.gz},<application/postscript> zathura %f, pqiv %f,

" Audio
filetype {*.wav,*.mp3,*.flac,*.m4a,*.wma,*.ape,*.ac3,*.og[agx],*.spx,*.opus},<audio/*>
       \ mpv --no-video %f,
       \ ffplay -nodisp -autoexit %c,
fileviewer {*.mp3},<audio/mpeg> mp3info
fileviewer {*.flac},<audio/flac> soxi

" Video
filextype {*.avi,*.mp4,*.wmv,*.dat,*.3gp,*.ogv,*.mkv,*.mpg,*.mpeg,*.vob,*.fl[icv],*.m2v,*.mov,*.webm,*.mts,*.m4v,*.r[am],*.qt,*.divx,*.as[fx]},<video/*>
        \ smplayer %f %i,
        \ vlc %f %i,
		\ pqiv  %f %i,
        \ ffplay -fs -autoexit %f,

filextype {*.m3u},<video/*>
		\ mpv %f,
        \ smplayer %f %i,

fileviewer {*.avi,*.mp4,*.wmv,*.dat,*.3gp,*.ogv,*.mkv,*.mpg,*.mpeg,*.vob,*.fl[icv],*.m2v,*.mov,*.webm,*.mts,*.m4v,*.r[am],*.qt,*.divx,*.as[fx]},<video/*>
         \ ffprobe -pretty %c 2>&1
" fileviewer *.avi,*.mp4,*.wmv,*.dat,*.3gp,*.ogv,*.mkv,*.mpg,*.mpeg,*.vob,
" 	\*.fl[icv],*.m2v,*.mov,*.webm,*.mts,*.m4v,*.r[am],*.qt,*.divx,
" 	\ vifmimg videopreview %px %py %pw %ph %c
" 	\ %pc
" 	\ vifmimg clear

" Web
filextype {*.html,*.htm},<text/html>
        \ firefox %f &,
        \ code %f %i,
		\ w3m %c
filetype {*.html,*.htm},<text/html> links, nvim, lynx

" Man page
filetype {*.[1-8]},<text/troff> man ./%c
fileviewer {*.[1-8]},<text/troff> man ./%c | col -b

filetype {*.7z,*.zip,*.zip,*.jar,*.war,*.ear,*.oxt,*.apkg,*.tar,*.tar.bz2,*.tbz2,*.tgz,*.tar.gz,*.tar.xz,*.txz},
			\ xarchiver %f
fileviewer *.zip,*.jar,*.war,*.ear,*.oxt zip -sf %c
fileviewer *.tgz,*.tar.gz tar -tzf %c
fileviewer *.tar.bz2,*.tbz2 tar -tjf %c
fileviewer *.tar.txz,*.txz xz --list %c
fileviewer {*.tar},<application/x-tar> tar -tf %c

" Office files
filextype {*.odt,*.ods,*.doc,*.docx,*.xls,*.xlsx,*.csv,*.odp,*.pptx,*.ppt},
         \<application/vnd.openxmlformats-officedocument.*,application/msword,application/vnd.ms-excel>
        \ libreoffice %f &
fileviewer {*.doc},<application/msword> catdoc %c
fileviewer {*.docx},<application/vnd.openxmlformats-officedocument.wordprocessingml.document>
         \ docx2txt.pl %f -

"e-book
filextype {*.cbr,*cbz} pqiv %f,
filextype {*.mobi,*.epub,*azw3,*azw,*pobi} 
		\ FBReader %f %i,
		\ ebook-viewer %f %i, 
		\ xreader %f %i,
		" \ bookworm %f %i,

filetype {*.md,*.txt,*.adoc,*.lua,*.csv,*.java,*.ts,*.css,*.js,*.ks} nvim
filextype *.md,*.txt
        \ {Open with typora}
        \ typora %f %i,
        \ {Open with mousepad}
        \ mousepad %f %i,

"Check hash sum MD5 SHA1 SHA256 SHA512
filetype *.md5 md5sum -c %f %S,
filetype *.sha1 sha1sum -c %f %S,
filetype *.sha256 sha256sum -c %f %S,
filetype *.sha512 sha512sum -c %f %S,
 
" Djvu
filextype {*.djvu},<image/vnd.djvu>
        \ pqiv %f %i,
        \ zathura %f %i,

" bat viewer
fileviewer {*.md,*.txt,*.adoc,*.lua,*.csv,*.html,*.htm,*.java,*.kt,*.kts,*.sh,*.js,*.ts,*.css,*.scss,*.json,*.yml,*.yaml,*.toml} 
	\ bat --color always --plain %c

" Images
filextype {*.bmp,*.jpg,*.jpeg,*.png,*.gif,*.xpm,*.webp,*.webm,*.svg},<image/*>
        \ pqiv -f %f,
        \ sxiv -fa %f %i,
		" \ echo %f > ~/test,
" kitty 
" fileviewer {*.bmp,*.jpg,*.jpeg,*.png,*.gif,*.xpm},<image/*>
" 	\ kitty +icat --place %pwx%ph@%pxx%py  --silent %c
" 	\ %pc
" 	\ kitty icat --clear --silent %pd

	 " \ identify %f

" wezterm
fileviewer *.bmp,*.jpg,*.jpeg,*.png,*.gif,*.xpm wezterm imgcat --width %pw --height %ph %c:p %pd

 " w3m
 " fileviewer *.bmp,*.jpg,*.jpeg,*.png,*.gif,*.xpm
 "          \ imgt %px %py %pw %ph %c
 "          \ %pc
 "          \ imgc %px %py %pw %ph

"ueberzung
" fileviewer *.bmp,*.jpg,*.jpeg,*.png,*.xpm
" 	\ vifmimg draw %px %py %pw %ph %c
" 	\ %pc
" 	\ vifmimg clear

" fileviewer *.ico
" 	\ vifmimg magickpreview %px %py %pw %ph %c
" 	\ %pc
" 	\ vifmimg clear

" DEVICONS works in > 8.2 vifm
" file types
set classify=' :dir:/, :exe:, :reg:, :link:'
" various file names
set classify+=' ::../::, ::*.sh::, ::*.[hc]pp::, ::*.[hc]::, ::/^copying|license$/::, ::.git/,,*.git/::, ::*.epub,,*.fb2,,*.djvu::, ::*.pdf::, ::*.htm,,*.html,,**.[sx]html,,*.xml::'
" archives
set classify+=' ::*.7z,,*.ace,,*.arj,,*.bz2,,*.cpio,,*.deb,,*.dz,,*.gz,,*.jar,,*.lzh,,*.lzma,,*.rar,,*.rpm,,*.rz,,*.tar,,*.taz,,*.tb2,,*.tbz,,*.tbz2,,*.tgz,,*.tlz,,*.trz,,*.txz,,*.tz,,*.tz2,,*.xz,,*.z,,*.zip,,*.zoo::'
" images
set classify+=' ::*.bmp,,*.gif,,*.jpeg,,*.jpg,,*.ico,,*.png,,*.ppm,,*.svg,,*.svgz,,*.tga,,*.tif,,*.tiff,,*.xbm,,*.xcf,,*.xpm,,*.xspf,,*.xwd::'
" audio
set classify+=' ::*.aac,,*.anx,,*.asf,,*.au,,*.axa,,*.flac,,*.m2a,,*.m4a,,*.mid,,*.midi,,*.mp3,,*.mpc,,*.oga,,*.ogg,,*.ogx,,*.ra,,*.ram,,*.rm,,*.spx,,*.wav,,*.wma,,*.ac3::'
" media
set classify+=' ::*.avi,,*.ts,,*.axv,,*.divx,,*.m2v,,*.m4p,,*.m4v,,.mka,,*.mkv,,*.mov,,*.mp4,,*.flv,,*.mp4v,,*.mpeg,,*.mpg,,*.nuv,,*.ogv,,*.pbm,,*.pgm,,*.qt,,*.vob,,*.wmv,,*.xvid::'
" office files
set classify+=' ::*.doc,,*.docx::, ::*.xls,,*.xls[mx]::, ::*.pptx,,*.ppt::'

" BOOKMARKS {{{
 
" show all bookmarks
nmap bb :marks <cr> 
" :mark mark /full/directory/path [filename]
mark / /
mark A /etc/apt
mark b /home/miro/.bin
mark c /home/miro/.config
mark C /home/miro/Code
mark d /home/miro/Downloads
mark D /home/miro/Documents
mark e /home/miro/Ext
mark q /home/miro/.config/qutebrowser
mark h /home/miro 
mark i /home/miro/Documents/Nauka/inwestycje
mark k /media/multimedia/kursy/Spring
mark l /home/miro/.local
mark m /media/multimedia
mark M /media/multi/.mumia
mark n /home/miro/Documents/notebook
mark o /home/miro/Pictures
mark p /home/miro/Code/Projects
mark r /run/media/miro
" mark s /home/miro/Code/SourceCode
mark s /home/miro/Code/blog/scully/miroslaw
mark t /home/miro/.local/share/vifm/Trash
mark T /home/miro/.local/share/Trash
mark u /home/miro/Documents/Ustawienia
mark v /home/miro/Videos
mark y /home/miro/Videos/YouTube
mark w /media/winD
mark W /media/winC
" }}} 

" vim: foldmethod=marker
